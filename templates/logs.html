<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Log Viewer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        h1 { color: #333; }
        .log-container { background-color: #f4f4f4; border: 1px solid #ddd; padding: 10px; }
        .log-entry { 
            font-family: ui-serif; 
            margin-bottom: 1px; /* 保持间距为0 */
            padding: 2px; /* 轻微的内边距 */
        }
        .highlight { 
            color: red; /* 设置文本颜色为红色 */
        }
    </style>
</head>
<body>
    <div id="game-info-container">
        <h2>Game Information</h2>
        <p id="game-id">Game ID: <span></span></p>
        <p id="pool-amount">Pool Amount: <span></span></p>
        <p id="player-amount">Player Amount: <span></span></p>
        <p id="game-time">Game Time: <span></span></p>
    </div>
    <button id="enter-game">Enter Game as JohnDoe</button>
    <h1>Recent Log Entries</h1>
    <div class="log-container">
        {% for line in logs %}
            <div class="log-entry" id="log-entry-{{ loop.index }}">
                {{ line }}
            </div>
        {% endfor %}
    </div>
    <script>
document.addEventListener("DOMContentLoaded", function() {
    var entries = document.querySelectorAll('.log-entry');
    entries.forEach(function(entry) {
        if (entry.textContent.includes('game_logic')) {
            entry.classList.add('highlight');
        }
    });

    var ws = new WebSocket('wss://api.balaton.bet/ws/game');
    ws.onopen = function() {
        console.log('WebSocket connection established');
    };
    ws.onmessage = function(event) {
        console.log('Message from server ', event.data);
        const response = JSON.parse(event.data);
        switch (response.type) {
            case 'game_info':
                console.log('Received:', response.type);
                displayGameInfo(response.data);
                break;
            case 'test_info':
                console.log('Received:', response.type, response.data);
                break;
            case 'notification':
                displayNotification(response.data);
                break;
            case 'success':
                console.log('Success:', response.data);
                break;
            default:
                console.log('Unknown message type:', response.type);
        }
    };
    ws.onclose = function() {
        console.log('WebSocket connection closed');
    };
    ws.onerror = function(error) {
        console.error('WebSocket error:', error);
    };

    document.getElementById('enter-game').addEventListener('click', function() {
        const entranceData = {
            type: "entrance",
            data: {
                player_name: "JohnDoe",
                payment: 40
            }
        };
        ws.send(JSON.stringify(entranceData));
    });

    function displayGameInfo(info) {
        document.querySelector('#game-id span').textContent = info.game_id;
        document.querySelector('#pool-amount span').textContent = info.pool_amount;
        document.querySelector('#player-amount span').textContent = info.player_amount;
        document.querySelector('#game-time span').textContent = info.game_time;
    }

    function displayNotification(notification) {
        console.log('Notification:', notification);
    }
});
    </script>
</body>
</html>